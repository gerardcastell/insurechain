// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Coverage {
  third_party_liability
  wildlife_collision
  theft
  roadside_assistance
  fire_windscreen
  vehicle_damages
  replacement_vehicle
}

enum FuelType {
  gasoline
  diesel
  hybrid
  electric
}

enum ParkingType {
  street
  collective_car_park
  collective_car_park_surveillance
  garage
}

model User {
  id              Int     @default(autoincrement()) @id
  email           String  @unique
  password        String
  proposals       Proposal[]
}


model Proposal {
  id                Int      @default(autoincrement()) @id
  policyHolder      User @relation(fields: [policyHolderId], references: [id])
  policyHolderId    Int
  coverages         CoverageType[]
  riskObject        RiskObject?
  riskSubject       RiskSubject?
  onBlockchain      Boolean? @default(false)
}

model RiskObject {
  id            Int @default(autoincrement()) @id
  maker         String
  model         String
  doorsNumber   Int
  fuelType      FuelType
  power         Int
  purchaseDate  DateTime
  releaseDate   DateTime
  version       String
  retailPrice   Float
  plate         String
  kmsYear       Int
  parking       ParkingType
  proposal      Proposal @relation(fields: [proposalId],references: [id])
  proposalId    Int @unique
}

model RiskSubject {
  id              Int     @default(autoincrement()) @id
  name            String
  licenseType     String
  documentNumber  String
  birthDate       DateTime
  proposal        Proposal  @relation(fields: [proposalId], references: [id])
  proposalId      Int @unique
}

model CoverageProduct {
  id                  Int @default(autoincrement()) @id
  identifier          Coverage @unique
  order               Int?
  basePriceFactor     Float
  title               String
  description         String
}

model CoverageType {
  id                  Int @default(autoincrement()) @id
  identifier          Coverage @unique
  premium             Float
  title               String
  description         String
  proposal             Proposal @relation(fields: [proposalId], references: [id])
  proposalId          Int @unique
}

